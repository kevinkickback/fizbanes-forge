<div class="row">
    <!-- Race Selection -->
    <div class="col-12 mb-4" id="build-race">
        <div class="card">
            <div class="card-header py-2">
                <h5 class="mb-0">Race</h5>
            </div>
            <div class="card-body race-card-body split-card-body">
                <!-- Toggle button for info panel -->
                <button class="info-toggle-btn" id="raceInfoToggle" title="Toggle Details Panel">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <!-- Left Panel: Race Selection/Actions -->
                <div class="choices-panel" id="raceChoicesPanel">
                    <div class="input-group mb-2">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control" id="raceSearchInput" placeholder="Search races..."
                            autocomplete="off">
                    </div>
                    <div class="race-list" id="raceList">
                        <!-- Race items will be populated dynamically -->
                    </div>
                </div>

                <!-- Right Panel: Race Info/Details -->
                <div class="info-panel" id="raceInfoPanel" data-target="raceInfo">
                    <!-- Race details will be populated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Class Selection -->
    <div class="col-12 mb-4" id="build-class">
        <div class="card">
            <div class="card-header py-2">
                <h5 class="mb-0">Class</h5>
            </div>
            <div class="card-body class-card-body split-card-body">
                <!-- Toggle button for info panel -->
                <button class="info-toggle-btn" id="classInfoToggle" title="Toggle Details Panel">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <!-- Left Panel: Class Choices/Actions -->
                <div class="choices-panel" id="classChoicesPanel">
                    <!-- Class tabs for multiclass characters -->
                    <div class="class-tabs" id="classTabs" style="display:none;">
                        <div class="nav nav-pills" id="classTabsList"
                            style="flex-wrap: nowrap; overflow-x: auto; overflow-y: hidden; white-space: nowrap;"></div>
                    </div>

                    <!-- Class and subclass dropdowns hidden - now managed through class features -->
                    <div class="class-selectors" style="display: none;">
                        <div class="class-select-container">
                            <select class="form-select" id="classSelect">
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div class="class-select-container">
                            <select class="form-select" id="subclassSelect" disabled>
                                <option value="">Select Class First</option>
                            </select>
                        </div>
                    </div>

                    <!-- Class Choices Section -->
                    <div id="classChoicesContainer" style="display: none;">

                        <!-- Subclass Choice Section -->
                        <div id="subclassChoiceSection" style="display: none;">
                            <!-- Dynamically populated when subclass choice is needed -->
                        </div>

                        <!-- ASI/Feat Choice Section -->
                        <div id="asiChoiceSection" style="display: none;">
                            <!-- Dynamically populated when ASI is available -->
                        </div>

                        <!-- Class Feature Choices Section (Fighting Style, Metamagic, etc.) -->
                        <div id="classChoicesContent">
                            <!-- Class feature choices will be rendered here dynamically -->
                        </div>

                        <!-- Spell Notification Section -->
                        <div id="spellNotificationSection" style="display: none;">
                            <!-- Dynamically populated when spells are available -->
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Class Info/Details -->
                <div class="info-panel" id="classInfoPanel" data-target="classInfo">
                    <!-- Class details will be populated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Background -->
    <div class="col-12 mb-4" id="build-background">
        <div class="card">
            <div class="card-header py-2">
                <h5 class="mb-0">Background</h5>
            </div>
            <div class="card-body background-card-body split-card-body">
                <!-- Toggle button for info panel -->
                <button class="info-toggle-btn" id="backgroundInfoToggle" title="Toggle Details Panel">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <!-- Left Panel: Background Selection/Actions -->
                <div class="choices-panel" id="backgroundChoicesPanel">
                    <div class="input-group mb-2">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control" id="backgroundSearchInput"
                            placeholder="Search backgrounds..." autocomplete="off">
                    </div>
                    <div class="background-list" id="backgroundList">
                        <!-- Background items will be populated dynamically -->
                    </div>
                </div>

                <!-- Right Panel: Background Info/Details -->
                <div class="info-panel" id="backgroundInfoPanel" data-target="backgroundInfo">
                    <!-- Background details will be populated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Ability Scores -->
    <div class="col-12 mb-4" id="build-ability-scores">
        <div class="card">
            <div class="card-header py-2 d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Ability Scores</h5>
                <!-- Point Buy Counter -->
                <div id="pointBuyCounter" style="display: none;">
                    <div class="points-remaining-display">
                        <strong>Points Remaining:</strong> <span id="pointBuyDisplay">27</span>
                    </div>
                </div>
            </div>
            <div class="card-body ability-score-card-body split-card-body">
                <!-- Toggle button for info panel -->
                <button class="info-toggle-btn" id="abilityScoreInfoToggle" title="Toggle Info Panel">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <!-- Left Panel: Method Tabs and Ability Scores -->
                <div class="choices-panel" id="abilityScoreChoicesPanel">
                    <!-- Method Tabs -->
                    <div class="ability-method-tabs mb-3" id="abilityMethodTabs">
                        <div class="nav nav-pills" id="abilityMethodTabsList"></div>
                    </div>

                    <!-- Ability Score Grid -->
                    <div class="ability-score-container">
                        <div class="ability-score-grid">
                            <div class="ability-score-box" data-ability="strength">
                                <h6 class="ability-label">STRENGTH</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                            <div class="ability-score-box" data-ability="dexterity">
                                <h6 class="ability-label">DEXTERITY</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                            <div class="ability-score-box" data-ability="constitution">
                                <h6 class="ability-label">CONSTITUTION</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                            <div class="ability-score-box" data-ability="intelligence">
                                <h6 class="ability-label">INTELLIGENCE</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                            <div class="ability-score-box" data-ability="wisdom">
                                <h6 class="ability-label">WISDOM</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                            <div class="ability-score-box" data-ability="charisma">
                                <h6 class="ability-label">CHARISMA</h6>
                                <div class="score">10</div>
                                <div class="modifier">+0</div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-light me-1" data-action="decrease">-</button>
                                    <button class="btn btn-sm btn-light" data-action="increase">+</button>
                                </div>
                                <div class="bonus"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Ability Choices (racial/class bonuses) -->
                    <div class="ability-bonuses-container mt-3" id="abilityBonusesNotes">
                        <!-- Ability score bonuses notes will be displayed here -->
                    </div>
                </div>

                <!-- Right Panel: Skill Info on Hover -->
                <div class="info-panel" id="abilityScoreInfoPanel" data-target="abilityScoreInfo">
                    <div class="info-content" id="abilityScoreInfoContent">
                        <h6>Hover over an ability score</h6>
                        <p class="text-muted small">Hover over any ability score to see which skills it affects.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Proficiencies -->
    <div class="col-12 mb-4" id="build-proficiencies">
        <div class="card">
            <div class="card-header py-2">
                <h5 class="mb-0">Proficiencies</h5>
            </div>
            <div class="card-body proficiencies-card-body split-card-body">
                <!-- Toggle button for info panel -->
                <button class="info-toggle-btn" id="proficienciesInfoToggle" title="Toggle Details Panel">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <!-- Left Panel: Proficiency Selection -->
                <div class="choices-panel" id="proficienciesChoicesPanel">
                    <div class="accordion accordion-flush" id="proficienciesAccordion">
                        <!-- Proficiency accordions will be populated dynamically -->
                    </div>
                    <!-- Proficiency Notes showing sources -->
                    <div id="proficienciesNotes" class="proficiency-notes-container"></div>
                </div>

                <!-- Right Panel: Proficiency Info/Details -->
                <div class="info-panel" id="proficienciesInfoPanel" data-target="proficienciesInfo">
                    <!-- Proficiency details will be populated dynamically on hover -->
                </div>
            </div>
        </div>
    </div>
</div>